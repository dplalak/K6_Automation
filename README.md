### k6 Automation

API load testing powered by k6, producing an HTML report (k6-reporter). Runnable locally and in GitHub Actions.

---

## Requirements

- k6 v0.51.0+ (locally) or GitHub Actions (installed via `grafana/setup-k6-action`)

## Installation

Install k6 locally.

---

## Environment configuration

Required environment variable:

- API_KEY – sent in the `x-api-key` request header

PowerShell (Windows):

```powershell
$env:API_KEY = "<your_api_key>"
k6 run load-test.js
```

Note: `load-test.js` reads `__ENV.API_KEY` and forwards it as the `x-api-key` header.

---

## Running tests

- Local (after setting `API_KEY`): `k6 run load-test.js`

---

## Reports

- HTML report generated by `handleSummary` using `k6-reporter`
- Output file: `results.html`

---

## Project structure

```
K6_Automation/
├─ README.md
├─ load-test.js               # k6 script with options, thresholds, and handleSummary
├─ results.html               # HTML report (created after a run)
└─ .github/
   └─ workflows/
      └─ k6-tests-pipeline.yml
```

---

## CI/CD – GitHub Actions

Workflow: `.github/workflows/k6-tests-pipeline.yml`

- Triggers: `workflow_dispatch` and schedule (UTC): `30 17 * * *`
- Steps: checkout, setup k6, `k6 run load-test.js`, upload `results.html`
- Required repository secret:
  - `API_KEY_SECRET` – exposed to the job as env `API_KEY`
- Artifacts: `k6-results` (contains `results.html`)

---

## Optimization suggestions

### 1. Parameterization and scenarios
- Introduce environment variables for the base URL and endpoints (e.g., `BASE_URL`)
- Consider ramping scenarios (`ramping-vus`, `stages`) to better simulate real-world traffic patterns

### 2. Reporting and Observability
- Integrate with Grafana Cloud or InfluxDB for long-term metrics storage and observability

### 3. Automation and notifications
- Add Slack or Microsoft Teams notifications for CI job results
- Execute load tests on pull requests or selected branches

---

